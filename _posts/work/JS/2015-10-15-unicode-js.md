---
layout: post
title: Unicode与JavaScript详解
date: 2015-10-15 21:05:33
category: "javascript"
--- 

[原文地址](http://www.ruanyifeng.com/blog/2014/12/unicode.html)

## 基础部分

1. unicode编码只规定了码点：
	- 共17个平面，一个基本平面，16个辅助平面
	- 所以理论上unicode字符集只需要2的21次就可以表示完整了
2. UTF-32共有2的32次方个空间，有点浪费空间
3. UTF-8是一种编程编码方式，字符长度从1-4字节不等
4. UTF-16字符长度为2或者4字节
	- >说来很巧妙，我也不知道是不是故意的设计，在基本平面内，从U+D800到U+DFFF是一个空段，即这些码点不对应任何字符。因此，这个空段可以用来映射辅助平面的字符。具体来说，辅助平面的字符位共有220个，也就是说，对应这些字符至少需要20个二进制位。UTF-16将这20位拆成两半，前10位映射在U+D800到U+DBFF（空间大小2的10次方），称为高位（H），后10位映射在U+DC00到U+DFFF（空间大小2的10次方），称为低位（L）。这意味着，一个辅助平面的字符，被拆成两个基本平面的字符表示
		+ 当你读到低2字节在U+D800到U+DBFF之间时，就知道这不是一个有效字符，需要和接下来的2字节连在一起使用
		+ 接下来的2字节一定在U+DC00到U+DFFF之间
		+ 2+2共4字节并不是直接就是unicode，而是要进行转换,这32位本质上会映射为一个20为的码点
		+ 映射出来的20位码点才是真正的unicode

## JS部分

1. ES 5使用的是已经被废弃的UCS-2编码方式
	- 是一种只用两字节表示所有编码的方式(肯定表示不完)
	- ES 5中所有字符都是两字节的，所以只要遇到4字节就会出错
2. ES 6支持了4字节编码方式
	- 有一些特殊的字符会有两种不同的表示方法，但是却表示的是同一个意思，在判断字符串相等时要特别注意